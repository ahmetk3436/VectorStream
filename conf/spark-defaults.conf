# Spark Kafka Integration Configuration
spark.jars.packages org.apache.spark:spark-sql-kafka-0-10_2.12:3.5.0
spark.sql.streaming.kafka.useDeprecatedOffsetFetching false
spark.sql.adaptive.enabled true
spark.sql.adaptive.coalescePartitions.enabled true
spark.serializer org.apache.spark.serializer.KryoSerializer

# KAFKA-1894 fix: UninterruptibleThread kullan覺m覺
spark.sql.streaming.kafka.useUninterruptibleThread true
spark.streaming.kafka.consumer.cache.enabled false
spark.streaming.kafka.consumer.poll.ms 5000
spark.streaming.stopGracefullyOnShutdown true
spark.sql.streaming.stopActiveRunOnRestart true

# Kafka consumer timeout ayarlar覺
spark.sql.streaming.kafka.consumer.requestTimeoutMs 30000
spark.sql.streaming.kafka.consumer.sessionTimeoutMs 30000
spark.sql.streaming.kafka.consumer.heartbeatIntervalMs 3000

# Thread interrupt handling
spark.task.killThread.enabled false
spark.task.interruptOnCancel false

# Ek Kafka optimizasyonlar覺
spark.sql.streaming.kafka.consumer.pollTimeoutMs 5000
spark.sql.streaming.kafka.consumer.fetchOffset.numRetries 3

# Log4j configuration for KAFKA-1894 fix
spark.driver.extraJavaOptions -Dlog4j.configuration=file:conf/log4j.properties
spark.executor.extraJavaOptions -Dlog4j.configuration=file:conf/log4j.properties
